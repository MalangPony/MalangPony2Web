<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">

<meta property="og:title" content="말랑포니2!" />
<meta property="og:type" content="website" />
<!-- TODO: Change below to <?php echo $webroot;?> -->
<meta property="og:url" content="https://testing.malangpony.com" />
<meta property="og:image" content="https://testing.malangpony.com/image/MPN_LogoV2_PNG-400dpi-WithBG_ResizeW2000px.png" />
<meta property="og:description" content="한국의 마이리틀포니 행사, 말랑포니입니다!" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="styles.css" rel="stylesheet" />
</head>

<body>
<div id="whole-screen-div" class="fullsize">
  
  <div id="master-hanmari-container" class="fullsize" style="z-index:20;pointer-events:none;">
    <div id="l2d-container" >
      <canvas id="l2d-canvas" style="width:100%;height:100%;"></canvas>
    </div>
    
    <div id="hmr-image-container">
      <img id="hmr-ground" src="sprites-prototype/MPN2-Prototype-Image-Hanmari4.png" style="z-index:3;opacity:0;">
      <img id="hmr-flash01" src="sprites-prototype/MPN2-Prototype-Image-Hanmari3.png" style="z-index:2;opacity:0;">
      <img id="hmr-base" src="sprites-prototype/MPN2-Prototype-Image-Hanmari2.png" style="z-index:1;">
    </div>
  </div>
  <div id="stickies" class="fullsize" style="z-index:80;pointer-events:none;">
    <div id="sidebar-animation-container">
        <div id="sidebar-intro-anim" style="display:none;">
          <div id="letter-magic-spritesheet-animation"></div>
        </div>
      </div>
    <div id="sidebar-positioner" class="fullsize" style="z-index:10;">
      <div id="sidebar" class="css-filters" style="pointer-events:auto;display:none;">
        <div id="sidebar-content">
        <div class="sb-link sb-link-active sb-link-toplevel sb-link-selected" pageid="intro">
          <span class="langspan-en">Home</span>
          <span class="langspan-ko">홈</span>
        </div>
        
        <div class="sb-link sb-link-active sb-link-toplevel" pageid="news">
          <span class="langspan-en">News</span>
          <span class="langspan-ko">소식</span>
        </div>
        
        <div class="sb-category-container">
          <div class="sb-category-header">
            <span class="sbch-icon"></span>
            <span class="langspan-en">About us</span>
            <span class="langspan-ko">소개</span>
          </div>
          <div class="sb-category-content">
            <div class="sb-link sb-link-active sb-link-sublevel" pageid="about">
              <span class="langspan-en">Introduction</span>
              <span class="langspan-ko">개요</span>
            </div>
            <div class="sb-link sb-link-disabled sb-link-sublevel" pageid="previous">
              <span class="langspan-en">Previous Events</span>
              <span class="langspan-ko">이전 행사</span>
            </div>
            <div class="sb-link sb-link-active sb-link-sublevel" pageid="coc">
              <span class="langspan-en">Code of Conduct</span>
              <span class="langspan-ko">규칙</span>
            </div>
            <div class="sb-link sb-link-disabled sb-link-sublevel" pageid="mascot">
              <span class="langspan-en">Our Mascots</span>
              <span class="langspan-ko">마스코트</span>
            </div>
          </div>
        </div>
        
        <div class="sb-category-container">
          <div class="sb-category-header">
            <span class="sbch-icon"></span>
            <span class="langspan-en">The Event</span>
            <span class="langspan-ko">행사</span>
          </div>
            <div class="sb-category-content">
              <div class="sb-link sb-link-active sb-link-sublevel" pageid="timetable">
              <span class="langspan-en">Timetable</span>
              <span class="langspan-ko">시간표</span>
            </div>
            <div class="sb-link sb-link-active sb-link-sublevel" pageid="venue">
              <span class="langspan-en">Venue</span>
              <span class="langspan-ko">행사장</span>
            </div>
            <div class="sb-link sb-link-disabled sb-link-sublevel" pageid="conbook">
              <span class="langspan-en">Conbook</span>
              <span class="langspan-ko">콘북</span>
            </div>
          </div>
        </div>
        
        <div class="sb-category-container">
          <div class="sb-category-header">
            <span class="sbch-icon"></span>
            <span class="langspan-en">Participate</span>
            <span class="langspan-ko">참가하기</span>
          </div>
          <div class="sb-category-content">
            <div class="sb-link sb-link-disabled sb-link-sublevel" pageid="register">
              <span class="langspan-en">Registration</span>
              <span class="langspan-ko">등록</span>
            </div>
            <div class="sb-link sb-link-disabled sb-link-sublevel" pageid="involved">
              <span class="langspan-en">Get Involved</span>
              <span class="langspan-ko">모집</span>
            </div>
          </div>
        </div>
        
        <div class="sb-category-container">
          <div class="sb-category-header">
            <span class="sbch-icon"></span>
            <span class="langspan-en">Support</span>
            <span class="langspan-ko">지원 및 도움</span>
          </div>
          <div class="sb-category-content">
            <div class="sb-link sb-link-disabled sb-link-sublevel" pageid="credits">
              <span class="langspan-en">Staff</span>
              <span class="langspan-ko">크레딧</span>
            </div>
            <div class="sb-link sb-link-disabled sb-link-sublevel" pageid="sponsors">
              <span class="langspan-en">Sponsors</span>
              <span class="langspan-ko">스폰서</span>
            </div>
            <div class="sb-link sb-link-disabled sb-link-sublevel" pageid="inquiries">
              <span class="langspan-en">Inquiries</span>
              <span class="langspan-ko">문의</span>
            </div>
          </div>
        </div>
        
        </div> <!-- #sidebar-content -->
      </div><!-- #sidebar -->
    </div> <!-- sidebar-positioner -->
    
    <div id="langswitch-positioner" class="fullsize"  style="z-index:5;">
      <div id="langswitch-btn"  style="pointer-events:auto;">
        <span class="langspan-en">한국어</span>
        <span class="langspan-ko">English</span>
      </div>
    </div>
    
    <div id="sb-button-positioner" class="fullsize" style="z-index:6;">
      <img src="sprites/OBJ-002_RESIZE.png" id="sb-btn" style="pointer-events:auto;display:none;"> 
    </div>
    
    <div id="debug-print-area" style="z-index:99;background-color:#00000040;color:#88FF8880;position:absolute;bottom:0;left:0;width:160px;font-size:10px;font-family:monospace;font-weight:700;padding:4px;display:flex;flex-direction:column-reverse;">
      <div id="debug-print-fps">-</div>
      <div id="debug-print-fps2">-</div>
      <div id="debug-print-fps3">-</div>
      <div id="debug-print-acms">-</div>
      <div id="debug-print-stars">-</div>
      <div id="debug-print-particles">-</div>
      <div id="debug-print-fl">-</div>
      <div style="display:flex;flex-direction:row;justify-content:space-around;margin-top:2px;">
        <div id="debug-button-feature-decrement" 
          style="width:60px;text-align:center;background:#00000040;pointer-events:auto;cursor:pointer;user-select:none;font-size:1.3em;">Feat-</div>
        <div id="debug-button-feature-increment" 
          style="width:60px;text-align:center;background:#00000040;pointer-events:auto;cursor:pointer;user-select:none;font-size:1.3em;">Feat+</div>
      </div>
      <div id="debug-button-feature-auto" 
          style="text-align:center;background:#00000040;pointer-events:auto;cursor:pointer;user-select:none;font-size:1.3em;">
          Auto Adjust: <span id="debug-print-faa"></span>
        </div>
      <div id="debug-print-features">-</div>
    </div>
  </div>
  <div id="content-scroller">
    <div id="mpn-logo-spacer">
      <div id="mpn_logo_container">
        <img id="logo-orig" src="sprites-prototype/MPN2-Prototype-Image-LogoPlain.png" style="z-index:3;opacity:0;">
        <img id="logo-flash01" src="sprites-prototype/MPN2-Prototype-Image-LogoGlow.png" style="z-index:2;opacity:0;">
        <img id="logo-base" src="sprites-prototype/MPN2-Prototype-Image-LogoDark.png" style="z-index:1;">
      </div>
    </div>
    <!-- 
      The below seemingly useless div is needed for Chromium browsers.
      Without this div, the chromium will anchor the scroll progress
      to the scroll-inviter, which makes the scroll oscillate
      along with the scroll-inviter animation.
      Adding this useless div fixes that.
    -->
    <div id="scroll-fixer"
      style="height:100lvh;position:absolute;top:0;left:0;right:0;opacity:0.00;background-color:#FFF;">
      ...
    </div>
    <div id="scroll-inviter-container">
      <div id="scroll-inviter" style="font-size:4em;color:#FFF;">▼</div>
    </div>
    
    <div id="intro-content-container" class="css-filters">
      
      <div id="screen-blanker"></div>
      
      <div id="afterscroll-content-container">
        <div id="page-intro" style="">
          <img id="logo-orig" src="sprites-prototype/MPN2-Prototype-Image-LogoPlain.png" style="margin-left:64px;margin-right:64px;max-width:min(600px , 100%);align-self:center;">
          
          <div style="font-size:3.0em;font-weight:700;color:#FFFFFF;text-align:center;">
            <span class="langspan-en">Malfoy!!!</span>
            <span class="langspan-ko">말포이!!!</span>
          </div>
          <div style="font-size:1.2em;font-weight:400;color:#FFFFFF;text-align:left;margin-top:32px;">
            <p>
              <span class="langspan-en">Hello Bronies.</span>
              <span class="langspan-ko">안녕하세요 브로니 여러분.</span>
              <br>
              <span class="langspan-en">Come to our event!</span>
              <span class="langspan-ko">와야겠지?</span>
              <br>
              <span class="langspan-en">or I'll kill u</span>
              <span class="langspan-ko">안오기만 해봐 그냥 콱</span>
            </p>
          </div>
          
          <div id="ticket" class="css-filters" style="pointer-events:auto;">
            <span class="langspan-en">Registration!</span>
            <span class="langspan-ko">지금 등록!</span>
          </div>
        </div>
        <div id="page-about" style="display:none;">
          <div style="margin-top:64px;font-size:3.0em;font-weight:700;color:#FFFFFF;text-align:center;">
            <span class="langspan-en">About!!!</span>
            <span class="langspan-ko">개요다!!!</span>
          </div>
        </div>
        <div id="page-coc" style="display:none;">
          <div style="margin-top:64px;font-size:3.0em;font-weight:700;color:#FFFFFF;text-align:center;">
            <span class="langspan-en">Code of Conduct!!!</span>
            <span class="langspan-ko">규칙이다!!!</span>
          </div>
        </div>
        <div id="page-news" style="display:none;">
          <div style="margin-top:64px;font-size:3.0em;font-weight:700;color:#FFFFFF;text-align:center;margin-bottom:32px;">
            <span class="langspan-en">NEWS!!!</span>
            <span class="langspan-ko">소식이다!!!</span>
          </div>
          <div id="bsky-outer">
            <bsky-embed 
              username="malangpony.bsky.social"
              load-more="true"
              disable-autoplay="true"
              ></bsky-embed>
          </div>
        </div>
        <div id="page-timetable" style="display:none;">
          <div style="margin-top:64px;font-size:3.0em;font-weight:700;color:#FFFFFF;text-align:center;margin-bottom:32px;">
            <span class="langspan-en">TTABLE!!!</span>
            <span class="langspan-ko">시간표!!!</span>
          </div>
          <div id="ttable-container">
            
          </div>
        </div>
        <div id="page-venue" style="display:none;">
          <div style="margin-top:64px;font-size:3.0em;font-weight:700;color:#FFFFFF;text-align:center;">
            <span class="langspan-en">MAP!!!</span>
            <span class="langspan-ko">지도???</span>
          </div>
          <div style="margin-top:24px;color:#FFFFFF;font-size:24px;font-weight:700;">
            <span class="langspan-ko">올댓마인드 문래</span>
            <span class="langspan-en">Allthatmind Munrae</span>
          </div>
          <div style="margin-top:16px;margin-bottom:12px;color:#FFFFFF;display:flex;flex-direction:row;gap:8px;">
            <a href="https://naver.me/xY4sP1mO" 
              class="linkbutton" 
              style="background-color:#a4ffac;color:#000;">
              <span class="langspan-ko">네이버 지도</span>
              <span class="langspan-en">Naver Maps</span>
            </a>
            <a href="https://kko.kakao.com/fqgpAUYJWh"
              class="linkbutton" 
              style="background-color:#ffffdc;color:#000;">
              <span class="langspan-ko">카카오맵</span>
              <span class="langspan-en">Kakao Maps</span>
            </a>
            <a href="https://maps.app.goo.gl/KuLBmTggmEXde3Q46"
              class="linkbutton" 
              style="background-color:#c9d1ff;color:#000;">
              <span class="langspan-ko">구글맵스</span>
              <span class="langspan-en">Google Maps</span>
            </a>
          </div>
          <div style="width:min(600px,100%);height:400px;position:relative;">
            <div id="map-btn-jump" style="position:absolute;top:16px;left:16px;width:128px;height:64px;background-color:#FF0;z-index:10;display:flex;flex-direction:row;align-items:center;">
              <img src="sprites-prototype/hanmari_CM_rev1_100px.png" style="height:48px;width:48px;margin:8px;">
              <div>말랑포니로<br>돌아가기</div>
            </div>
            <div id="kakaomap-content" style="width:100%;height:100%;"></div>
          </div>
          
        </div>
      </div>
    </div>
    
  </div>
  
  <div id="parallax-image-container" class="fullsize" style="z-index:-992;"></div>
  <canvas id="canvas-dyntex" class="fullsize" style="z-index:-995;"></canvas>
  <canvas id="canvas-fireworks" class="fullsize" style="z-index:-996;"></canvas>
  <canvas id="canvas-stars" class="fullsize" style="z-index:-998;"></canvas>
  <div id="sky-bg" class="fullsize" style="z-index:-999;"></div>
</div>

<!-- 3rd party JS libraries -->
<!-- Using CDN -->
<!--
<script type="module" src="https://cdn.jsdelivr.net/npm/bsky-embed/dist/bsky-embed.es.js" async></script>
<script src="CubismSDK/live2dcubismcore.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/pixi.js@6/dist/browser/pixi.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/pixi-live2d-display/dist/cubism4.min.js"></script>
<script src="https://unpkg.com/delaunator@5.0.0/delaunator.min.js"></script>
-->

<!-- KakaoMap API -->
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=2496ef721779170993fa8272a21b4f7a"></script>

<script>
/*
 * Important note: The Kakaomap Div MUST be visible at the time of map initialization. 
 * If it is display:none when it is initialized,it behaves in strange ways.
 * That is why we display the #page-venue div for a short while here.
 */
document.getElementById("page-venue").style.display="block";
var positionATM  = new kakao.maps.LatLng(37.520484, 126.887396); 
var container = document.getElementById('kakaomap-content'); 
let mbj=document.getElementById("map-btn-jump");
var options = { 
	center: positionATM, 
	level: 5
};
var kkm = new kakao.maps.Map(container, options);
// Note: Call kkm.relayout() on size changes!

/*
var mapTypeControl = new kakao.maps.MapTypeControl();
kkm.addControl(mapTypeControl, kakao.maps.ControlPosition.TOPRIGHT);

var zoomControl = new kakao.maps.ZoomControl();
kkm.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);
*/

let markerSizeMultiplier=0.3;
var markerImage = new kakao.maps.MarkerImage(
  'sprites-prototype/MPN2-Prototype-Image_MapMarker.png', 
  new kakao.maps.Size(300*markerSizeMultiplier, 300*markerSizeMultiplier), 
  {offset: new kakao.maps.Point(100*markerSizeMultiplier, 250*markerSizeMultiplier)});
var marker = new kakao.maps.Marker({
    position: positionATM,
    image:markerImage
});
marker.setMap(kkm);

let overlayContent='<div style="margin-top:12px;border:2px solid #F00;background-color:#F88;text-align:center;font-size:16px;">말랑포니 행사 장소<br><strong>올댓마인드</strong></div>'
var customOverlay = new kakao.maps.CustomOverlay({
    map: kkm,
    position: positionATM,
    content: overlayContent,
    yAnchor: 0.0
});

// Display button if venue is too off to the side
kakao.maps.event.addListener(kkm, 'bounds_changed', ()=>{
  let llb=kkm.getBounds();
  let s=llb.getSouthWest().getLat();
  let w=llb.getSouthWest().getLng();
  let n=llb.getNorthEast().getLat();
  let e=llb.getNorthEast().getLng();
  let ratioY=(positionATM.getLat()-s)/(n-s);
  let ratioX=(positionATM.getLng()-w)/(e-w);
  let centeredX=(ratioX<0.8) && (ratioX>0.2);
  let centeredY=(ratioY<0.8) && (ratioY>0.2);
  //if (llb.contain(positionATM)) mbj.style.display="none";
  if (centeredX && centeredY) mbj.style.display="none";
  else mbj.style.display="flex";
});
mbj.style.display="none";
mbj.addEventListener("click",()=>{
  kkm.panTo(positionATM);
});

// Hide it here, after initialization
document.getElementById("page-venue").style.display="none";

</script>

<!-- Serving local files -->
<script type="module" src="jslib/bsky-embed_0.2.7_bsky-embed.es.min.js" async></script>
<script src="CubismSDK/live2dcubismcore.min.js"></script>
<script src="jslib/pixijs_6.5.10_pixi.min.js"></script>
<script src="jslib/pixi-live2d-display_0.4.0_cubism4.min.js"></script>
<script src="jslib/delaunator_5.0.0.min.js"></script>

<!-- Ethically sourced, home-grown spaghetti -->
<script type="module" src="./js/l2d.js"></script>
<script type="module" src="./js/main.js"></script>
<script type="module" src="./js/perfmanager.js"></script>

<script>
// For debugging
let L2D;
import('./js/l2d.js').then(m => L2D = m);
let PerformanceManager;
import('./js/perfmanager.js').then(m => PerformanceManager = m);
</script>

</body>
</html>
